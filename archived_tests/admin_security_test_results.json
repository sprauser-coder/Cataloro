{
  "test_timestamp": "2025-09-11T06:50:38.902387",
  "jwt_token_generation": {
    "test_name": "JWT Token Generation",
    "success": true,
    "token_received": true,
    "token_analysis": {
      "token_type": "jwt",
      "is_jwt": true,
      "structure_valid": true,
      "header": {
        "alg": "HS256",
        "typ": "JWT"
      },
      "payload": {
        "user_id": "admin_user_1",
        "email": "admin@cataloro.com",
        "role": "admin",
        "user_role": "Admin",
        "exp": 1757659838
      },
      "has_required_fields": true,
      "required_fields_present": [
        "user_id",
        "email",
        "role"
      ],
      "missing_fields": []
    },
    "user_data": {
      "id": "admin_user_1",
      "username": "sash_admin",
      "email": "admin@cataloro.com",
      "full_name": "Sash",
      "name": "Sash Admin",
      "role": "admin",
      "user_role": "Admin",
      "registration_status": "Approved",
      "badge": "Admin",
      "is_business": false,
      "business_name": "",
      "verified": true,
      "is_active": true,
      "created_at": "2025-09-09T09:53:56.308000",
      "city": "System",
      "country": "Admin",
      "company_name": "",
      "first_name": "Sascha",
      "last_name": "Prauser",
      "password": "Start123",
      "vat_number": ""
    },
    "is_real_jwt": true,
    "has_required_fields": true,
    "token_not_mock": true
  },
  "admin_endpoints_with_auth": {
    "test_name": "Admin Endpoints With Auth",
    "success": true,
    "total_endpoints": 5,
    "successful_endpoints": 5,
    "success_rate": 100.0,
    "all_endpoints_accessible": true,
    "endpoint_results": [
      {
        "endpoint": "/admin/menu-settings",
        "method": "GET",
        "name": "Menu Settings GET",
        "success": true,
        "status": 200,
        "response_time_ms": 11.617898941040039,
        "authenticated_access": true
      },
      {
        "endpoint": "/admin/menu-settings",
        "method": "POST",
        "name": "Menu Settings POST",
        "success": true,
        "status": 200,
        "response_time_ms": 13.292312622070312,
        "authenticated_access": true
      },
      {
        "endpoint": "/admin/dashboard",
        "method": "GET",
        "name": "Admin Dashboard",
        "success": true,
        "status": 200,
        "response_time_ms": 128.25870513916016,
        "authenticated_access": true
      },
      {
        "endpoint": "/admin/users",
        "method": "GET",
        "name": "Admin Users",
        "success": true,
        "status": 200,
        "response_time_ms": 11.523962020874023,
        "authenticated_access": true
      },
      {
        "endpoint": "/admin/performance",
        "method": "GET",
        "name": "Admin Performance",
        "success": true,
        "status": 200,
        "response_time_ms": 19.27328109741211,
        "authenticated_access": true
      }
    ]
  },
  "admin_endpoints_without_auth": {
    "test_name": "Admin Endpoints Without Auth",
    "success": true,
    "total_endpoints": 5,
    "properly_blocked_endpoints": 5,
    "vulnerable_endpoints": 0,
    "security_score": 100.0,
    "all_endpoints_secured": true,
    "endpoint_results": [
      {
        "endpoint": "/admin/menu-settings",
        "method": "GET",
        "name": "Menu Settings GET",
        "status": 403,
        "response_time_ms": 49.91006851196289,
        "properly_blocked": true,
        "security_vulnerability": false
      },
      {
        "endpoint": "/admin/menu-settings",
        "method": "POST",
        "name": "Menu Settings POST",
        "status": 403,
        "response_time_ms": 12.180089950561523,
        "properly_blocked": true,
        "security_vulnerability": false
      },
      {
        "endpoint": "/admin/dashboard",
        "method": "GET",
        "name": "Admin Dashboard",
        "status": 403,
        "response_time_ms": 48.84767532348633,
        "properly_blocked": true,
        "security_vulnerability": false
      },
      {
        "endpoint": "/admin/users",
        "method": "GET",
        "name": "Admin Users",
        "status": 403,
        "response_time_ms": 8.158445358276367,
        "properly_blocked": true,
        "security_vulnerability": false
      },
      {
        "endpoint": "/admin/performance",
        "method": "GET",
        "name": "Admin Performance",
        "status": 403,
        "response_time_ms": 48.874855041503906,
        "properly_blocked": true,
        "security_vulnerability": false
      }
    ],
    "vulnerable_endpoint_details": []
  },
  "admin_endpoints_invalid_tokens": {
    "test_name": "Admin Endpoints With Invalid Tokens",
    "success": true,
    "total_tokens_tested": 5,
    "properly_rejected_tokens": 4,
    "vulnerable_tokens": 0,
    "token_security_score": 80.0,
    "all_invalid_tokens_rejected": true,
    "token_results": [
      {
        "token_name": "Invalid Token 1",
        "token_value": "invalid_token_123",
        "status": 401,
        "properly_rejected": true,
        "security_vulnerability": false
      },
      {
        "token_name": "Invalid Token 2",
        "token_value": "Bearer fake_jwt_toke...",
        "status": 401,
        "properly_rejected": true,
        "security_vulnerability": false
      },
      {
        "token_name": "Mock Token",
        "token_value": "mock_token_admin_use...",
        "status": 401,
        "properly_rejected": true,
        "security_vulnerability": false
      },
      {
        "token_name": "Sample JWT",
        "token_value": "eyJhbGciOiJIUzI1NiIs...",
        "status": 401,
        "properly_rejected": true,
        "security_vulnerability": false
      },
      {
        "token_name": "Empty Token",
        "token_value": "",
        "status": 403,
        "properly_rejected": false,
        "security_vulnerability": false
      }
    ],
    "vulnerable_token_details": []
  },
  "role_based_access_control": {
    "test_name": "Role-Based Access Control",
    "success": true,
    "demo_user_role": "user",
    "total_endpoints": 4,
    "properly_blocked_endpoints": 4,
    "vulnerable_endpoints": 0,
    "rbac_security_score": 100.0,
    "rbac_working_correctly": true,
    "endpoint_results": [
      {
        "endpoint": "/admin/menu-settings",
        "name": "Menu Settings",
        "status": 403,
        "properly_blocked": true,
        "rbac_vulnerability": false
      },
      {
        "endpoint": "/admin/dashboard",
        "name": "Admin Dashboard",
        "status": 403,
        "properly_blocked": true,
        "rbac_vulnerability": false
      },
      {
        "endpoint": "/admin/users",
        "name": "Admin Users",
        "status": 403,
        "properly_blocked": true,
        "rbac_vulnerability": false
      },
      {
        "endpoint": "/admin/performance",
        "name": "Admin Performance",
        "status": 403,
        "properly_blocked": true,
        "rbac_vulnerability": false
      }
    ],
    "vulnerable_endpoint_details": []
  },
  "security_bypass_prevention": {
    "test_name": "Security Bypass Prevention",
    "success": true,
    "total_bypass_tests": 15,
    "properly_blocked_attempts": 15,
    "bypass_vulnerabilities": 0,
    "bypass_prevention_score": 100.0,
    "no_bypass_vulnerabilities": true,
    "bypass_test_results": [
      {
        "test_type": "Header Manipulation",
        "test_name": "Header Test 1",
        "headers": {
          "X-Admin-Override": "true"
        },
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Header Manipulation",
        "test_name": "Header Test 2",
        "headers": {
          "X-User-Role": "admin"
        },
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Header Manipulation",
        "test_name": "Header Test 3",
        "headers": {
          "X-Bypass-Auth": "true"
        },
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Header Manipulation",
        "test_name": "Header Test 4",
        "headers": {
          "Authorization": ""
        },
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Header Manipulation",
        "test_name": "Header Test 5",
        "headers": {
          "Authorization": "Basic YWRtaW46YWRtaW4="
        },
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "URL Manipulation",
        "test_name": "URL Test 1",
        "url": "/admin/../admin/dashboard",
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "URL Manipulation",
        "test_name": "URL Test 2",
        "url": "/admin/dashboard?admin=true",
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "URL Manipulation",
        "test_name": "URL Test 3",
        "url": "/admin/dashboard#bypass",
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "URL Manipulation",
        "test_name": "URL Test 4",
        "url": "/admin/dashboard/",
        "status": 403,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "URL Manipulation",
        "test_name": "URL Test 5",
        "url": "/ADMIN/DASHBOARD",
        "status": 404,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Method Manipulation",
        "test_name": "Method PUT",
        "method": "PUT",
        "status": 405,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Method Manipulation",
        "test_name": "Method PATCH",
        "method": "PATCH",
        "status": 405,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Method Manipulation",
        "test_name": "Method DELETE",
        "method": "DELETE",
        "status": 405,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Method Manipulation",
        "test_name": "Method OPTIONS",
        "method": "OPTIONS",
        "status": 405,
        "bypassed": false,
        "properly_blocked": true
      },
      {
        "test_type": "Method Manipulation",
        "test_name": "Method HEAD",
        "method": "HEAD",
        "status": 405,
        "bypassed": false,
        "properly_blocked": true
      }
    ],
    "vulnerability_details": []
  },
  "security_summary": {
    "overall_security_score": 95.0,
    "all_critical_checks_passed": true,
    "total_vulnerabilities_found": 0,
    "security_level": "SECURE",
    "critical_security_checks": {
      "jwt_tokens_working": true,
      "admin_endpoints_accessible_with_auth": true,
      "admin_endpoints_blocked_without_auth": true,
      "invalid_tokens_rejected": true,
      "rbac_working": true,
      "no_bypass_vulnerabilities": true
    },
    "individual_scores": {
      "authentication_required_score": 100.0,
      "token_validation_score": 80.0,
      "role_based_access_score": 100.0,
      "bypass_prevention_score": 100.0
    }
  }
}